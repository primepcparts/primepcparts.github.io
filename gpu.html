<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Graphics Cards Store</title>
  <!-- Bootstrap CSS (for carousel and general styling) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* Custom styles for the button */
    .btn-buy {
      background-color: #28a745; /* Green color */
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      font-size: 16px;
      text-align: center;
      width: 100%;
      cursor: pointer;
      border: none;
    }

    .btn-buy:hover {
      background-color: #218838; /* Darker green on hover */
    }

    .btn-buy:active {
      background-color: #1e7e34; /* Even darker green when clicked */
    }

    /* Full-screen modal styling */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease;
    }

    .modal.open {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      position: relative;
      max-width: 90%;
      max-height: 90%;
    }

    .modal-image {
      width: 100%;
      height: auto;
    }

    .close {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 30px;
      color: white;
      cursor: pointer;
      background: none;
      border: none;
    }

    #graphics-cards-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 20px;
    }

    .card {
      border: 1px solid #ddd;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .card-body {
      padding: 20px;
    }

    .carousel-item img {
      object-fit: contain;
      max-height: 300px;
    }
  </style>
</head>
<body>

<div class="container mt-5">
  <div id="graphics-cards-container" class="row">
    <!-- Dynamic content will be inserted here -->
  </div>
</div>

<!-- Full-screen modal for image viewing -->
<div id="fullScreenModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeFullScreen()">&times;</span>
    <img id="fullScreenImage" class="modal-image" />
  </div>
</div>

<!-- Bootstrap JS (for carousel) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script>
// Fetch data from Google Sheet using OpenSheet.elk.sh
const sheetUrl = 'https://opensheet.elk.sh/1iUhbStYP6d63-AFyalNRyLUAhsEhDf7JF0pzKoqYK6M/Sheet1';

fetch(sheetUrl)
  .then(response => response.json())
  .then(async (data) => {
    const container = document.getElementById('graphics-cards-container');

    // Loop through each item in the data
    for (let index = 0; index < data.length; index++) {
      const item = data[index];
      const folderName = item.PhotoFolder;

      // Construct local image paths based on the folder name
      const photos = await getLocalImagePaths(folderName);

      let carouselHtml = '';
      if (photos.length > 1) {
        const carouselId = `carousel-${item.Name.replace(/\s+/g, '-')}-${index}`;
        carouselHtml = `
          <div id="${carouselId}" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
              ${photos.map((photo, photoIndex) => `
                <div class="carousel-item ${photoIndex === 0 ? 'active' : ''}">
                  <img src="${photo}" class="d-block w-100 card-img-top" alt="${item.Name} Photo ${photoIndex + 1}" onclick="openFullScreenCarousel(${JSON.stringify(photos)}, ${photoIndex})">
                </div>
              `).join('')}
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#${carouselId}" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#${carouselId}" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>
        `;
      } else if (photos.length === 1) {
        carouselHtml = `<img src="${photos[0]}" class="card-img-top" alt="${item.Name}" onclick="openFullScreenCarousel(${JSON.stringify(photos)}, 0)">`;
      }

      const cardHtml = `
        <div class="col-md-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">${item.Name}</h5>
              ${carouselHtml}
              <p class="card-text"><strong>Price:</strong> ₹${item.Price}</p>
              <div class="form-group">
                <label for="quantity-${index}"><strong>Select Quantity:</strong></label>
                <select class="form-control" id="quantity-${index}">
                  ${generateQuantityOptions(item.Quantity)}
                </select>
              </div>
              <button class="btn-buy" onclick="buyItem('${item.Name}', '${item.Price}', ${item.Quantity}, ${index})">Buy It</button>
            </div>
          </div>
        </div>
      `;
      container.insertAdjacentHTML('beforeend', cardHtml);
    }
  })
  .catch(error => console.error('Error fetching data:', error));

// Mock function to get image paths based on folder name
async function getLocalImagePaths(folderName) {
  // Replace this with actual logic to get image paths from the folder
  return [
    `/path/to/images/${folderName}/image1.jpg`,
    `/path/to/images/${folderName}/image2.jpg`,
    `/path/to/images/${folderName}/image3.jpg`
  ];
}

function generateQuantityOptions(maxQuantity) {
  let optionsHtml = '';
  for (let i = 1; i <= maxQuantity; i++) {
    optionsHtml += `<option value="${i}">${i}</option>`;
  }
  return optionsHtml;
}

function buyItem(name, price, quantity, index) {
  alert(`Buying ${quantity} of ${name} for ₹${price}`);
}

// Full-screen image view functionality
function openFullScreenCarousel(images, index) {
  const modal = document.getElementById('fullScreenModal');
  const fullScreenImage = document.getElementById('fullScreenImage');
  fullScreenImage.src = images[index];
  modal.classList.add('open');
}

function closeFullScreen() {
  const modal = document.getElementById('fullScreenModal');
  modal.classList.remove('open');
}
</script>
</body>
</html>